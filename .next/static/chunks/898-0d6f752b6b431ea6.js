"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{48729:function(t,e,o){o.d(e,{z:function(){return r}});let r=[{id:1,name:"Level 1 — Comfort Zone",subtitle:"Market +10%",equityReturn:.1,bondReturn:.02,stress:.1,description:"Strong markets favor growth. Traditional allocations feel safe."},{id:2,name:"Level 2 — False Safety",subtitle:"Market –5%",equityReturn:-.05,bondReturn:.01,stress:.4,description:"Moderate drawdowns test diversification. Bonds partially compensate."},{id:3,name:"Level 3 — Market Stress",subtitle:"Market –30%",equityReturn:-.3,bondReturn:0,stress:.9,description:"Extreme stress breaks correlations. Only engineered outcomes survive."}]},2971:function(t,e,o){function r(t,e,o){let r=t.equityReturn,n=t.bondReturn,i=function(t,e){if(t>=0){let o=t*e.participation;return null==e.cap?o:Math.min(o,e.cap)}return t>=-e.buffer?0:t+e.buffer}(r,o.equityNote),u=function(t,e,o){let r=e.stress<.7&&t>-.18?.25*o.coupon:0,n=-(1-o.barrier),i=0;if(t<n){let e=t-n;i="hard"===o.protection?.65*e:e}return t<n&&i>0&&(i=0),{total:r+i,income:r,principalHit:i}}(r,e,o.incomeNote),l=o.structSplitEquityNote*i+(1-o.structSplitEquityNote)*u.total-(.002+.004*e.stress),a=.15*e.stress*(o.eq*o.fi),c=o.fi*n+o.eq*r+o.struct*l-a,s=o.eq*r;return{totalR:c,maxDD:Math.max(0,-(s+o.struct*l+o.fi*n)),income:o.struct*(1-o.structSplitEquityNote)*u.income}}function n(t,e){return r({equityReturn:t.equityReturn,bondReturn:t.bondReturn},t,e)}o.d(e,{ZX:function(){return r},oK:function(){return n}})},7898:function(t,e,o){o.d(e,{g:function(){return s}});var r=o(59625),n=o(48729),i=o(2971);class u{next(){return this.seed=(1664525*this.seed+1013904223)%4294967296,this.seed/4294967296}normal(t,e){return t+Math.sqrt(-2*Math.log(this.next()))*Math.cos(2*Math.PI*this.next())*e}constructor(t){this.seed=t}}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,o=new u(12345+1e3*t.id),r=[],n={1:.08,2:.1,3:.16}[t.id];for(let i=0;i<e;i++){let e=t.equityReturn+o.normal(0,n);e=Math.max(-.6,Math.min(.3,e));let i=t.bondReturn+o.normal(0,.01)+.25*t.stress*Math.min(0,e);i=Math.max(-.1,Math.min(.05,i)),r.push({equityReturn:e,bondReturn:i})}return r}function a(t,e){let o=t.map(t=>t.totalR),r=t.map(t=>t.maxDD),n=t.map(t=>t.income),i=o.reduce((t,e)=>t+e,0)/o.length,u=function(t){let e=[...t].sort((t,e)=>t-e),o=Math.max(1,Math.ceil(.1*e.length));return e.slice(0,o).reduce((t,e)=>t+e,0)/o}(o),l=r.reduce((t,e)=>t+e,0)/r.length,a=n.reduce((t,e)=>t+e,0)/n.length,c=150*(e.fi**2+e.eq**2+e.struct**2),s=0;e.fi>.7&&(s+=500*(e.fi-.7)**2),e.eq>.7&&(s+=800*(e.eq-.7)**2),e.eq>.85&&(s+=1500*(e.eq-.85)**2),e.struct>.6&&(s+=300*(e.struct-.6)**2),e.struct>.8&&(s+=500*(e.struct-.8)**2),(e.fi>.9||e.eq>.9||e.struct>.9)&&(s+=2e3*(Math.max(e.fi,e.eq,e.struct)-.9)**2);let f=400+100*i+15*a-60*l+120*u-c-s;return{meanR:i,cvar10:u,meanDD:l,meanIncome:a,penaltyDiv:c,penaltyConstraints:s,portfolioOutcomeScore:f}}let c={fi:.3,eq:.5,struct:.2,structSplitEquityNote:.6,equityNote:{buffer:.15,cap:.12,participation:1},incomeNote:{coupon:.1,barrier:.7,protection:"hard"}},s=(0,r.Ue)((t,e)=>({level:1,timeLeft:30,allocation:c,results:{},startLevel:e=>t({level:e,timeLeft:30}),tick:()=>{let o=e().timeLeft;o<=0||t({timeLeft:o-1})},setAllocation:o=>t({allocation:{...e().allocation,...o}}),finishLevel:()=>{let{level:o,allocation:r,results:u}=e(),c=n.z.find(t=>t.id===o),s=a(l(c,50).map(t=>(0,i.ZX)(t,c,r)),r),f={totalR:s.meanR,maxDD:s.meanDD,income:s.meanIncome},m=s.portfolioOutcomeScore,d=function(t,e){let o=l(t,50),r=null;for(let n=0;n<=100;n+=5)for(let u=0;u<=100-n;u+=5){let l=100-n-u;if(l<0)continue;let c=l/100,s=n/100,f=u/100;if(!(Math.abs(s+f+c-1)>.001))for(let n of[0,.2,.4,.5,.6,.8,1])for(let u of[.1,.15,.2,.3])for(let l of[.08,.1,.12,.15,null])for(let m of[.06,.08,.1,.12])for(let d of[.6,.7,.8])for(let p of["hard","soft"]){let h={fi:s,eq:f,struct:c,structSplitEquityNote:n,equityNote:{...e.equityNote,buffer:u,cap:l},incomeNote:{coupon:m,barrier:d,protection:p}},q=a(o.map(e=>(0,i.ZX)(e,t,h)),h),y=q.portfolioOutcomeScore;(!r||y>r.portfolioOutcomeScore)&&(r={a:h,portfolioOutcomeScore:y,metrics:q})}}if(!r)throw Error("No optimal allocation found for market environment ".concat(t.id));let n={totalR:r.metrics.meanR,maxDD:r.metrics.meanDD,income:r.metrics.meanIncome};return{a:r.a,portfolioOutcomeScore:r.portfolioOutcomeScore,outcome:n,metrics:r.metrics}}(c,{equityNote:r.equityNote,incomeNote:r.incomeNote}),p=d.outcome,h=d.portfolioOutcomeScore,q=Math.max(h,m-1e-6);t({results:{...u,[o]:{regime:c,user:f,userAlloc:{...r},userPortfolioOutcomeScore:m,optimal:p,optimalAlloc:d.a,optimalPortfolioOutcomeScore:h,displayedOptimalPortfolioOutcomeScore:q}}})},reset:()=>t({level:1,timeLeft:30,allocation:c,results:{}})}))}}]);