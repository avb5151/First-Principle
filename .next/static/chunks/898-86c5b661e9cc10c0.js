"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[898],{48729:function(t,e,r){r.d(e,{z:function(){return o}});let o=[{id:1,name:"Level 1 — Comfort Zone",subtitle:"Market +10%",equityReturn:.1,bondReturn:.02,stress:.1,description:"Strong markets favor growth. Traditional allocations feel safe."},{id:2,name:"Level 2 — False Safety",subtitle:"Market –5%",equityReturn:-.05,bondReturn:.01,stress:.4,description:"Moderate drawdowns test diversification. Bonds partially compensate."},{id:3,name:"Level 3 — Market Stress",subtitle:"Market –30%",equityReturn:-.3,bondReturn:0,stress:.9,description:"Extreme stress breaks correlations. Only engineered outcomes survive."}]},2971:function(t,e,r){function o(t,e,r){let o=t.equityReturn,n=t.bondReturn,i=function(t,e){if(t>=0){let r=t*e.participation;return null==e.cap?r:Math.min(r,e.cap)}return t>=-e.buffer?0:t+e.buffer}(o,r.equityNote),u=function(t,e,r){let o=e.stress<.7&&t>-.18?.25*r.coupon:0,n=-(1-r.barrier),i=0;if(t<n){let e=t-n;i="hard"===r.protection?.65*e:e}return t<n&&i>0&&(i=0),{total:o+i,income:o,principalHit:i}}(o,e,r.incomeNote),l=r.structSplitEquityNote*i+(1-r.structSplitEquityNote)*u.total-(.002+.004*e.stress),c=.15*e.stress*(r.eq*r.fi),a=r.fi*n+r.eq*o+r.struct*l-c,s=r.eq*o;return{totalR:a,maxDD:Math.max(0,-(s+r.struct*l+r.fi*n)),income:r.struct*(1-r.structSplitEquityNote)*u.income}}function n(t,e){return o({equityReturn:t.equityReturn,bondReturn:t.bondReturn},t,e)}r.d(e,{ZX:function(){return o},oK:function(){return n}})},7898:function(t,e,r){r.d(e,{g:function(){return s}});var o=r(59625),n=r(48729),i=r(2971);class u{next(){return this.seed=(1664525*this.seed+1013904223)%4294967296,this.seed/4294967296}normal(t,e){return t+Math.sqrt(-2*Math.log(this.next()))*Math.cos(2*Math.PI*this.next())*e}constructor(t){this.seed=t}}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=new u(12345+1e3*t.id),o=[],n={1:.08,2:.1,3:.16}[t.id];for(let i=0;i<e;i++){let e=t.equityReturn+r.normal(0,n);e=Math.max(-.6,Math.min(.3,e));let i=t.bondReturn+r.normal(0,.01)+.25*t.stress*Math.min(0,e);i=Math.max(-.1,Math.min(.05,i)),o.push({equityReturn:e,bondReturn:i})}return o}function c(t,e){let r=t.map(t=>t.totalR),o=t.map(t=>t.maxDD),n=t.map(t=>t.income),i=r.reduce((t,e)=>t+e,0)/r.length,u=function(t){let e=[...t].sort((t,e)=>t-e),r=Math.max(1,Math.ceil(.1*e.length));return e.slice(0,r).reduce((t,e)=>t+e,0)/r}(r),l=o.reduce((t,e)=>t+e,0)/o.length,c=n.reduce((t,e)=>t+e,0)/n.length,a=150*(e.fi**2+e.eq**2+e.struct**2),s=0;e.fi>.7&&(s+=500*(e.fi-.7)**2),e.eq>.7&&(s+=800*(e.eq-.7)**2),e.eq>.85&&(s+=1500*(e.eq-.85)**2),e.struct>.6&&(s+=300*(e.struct-.6)**2),e.struct>.8&&(s+=500*(e.struct-.8)**2),(e.fi>.9||e.eq>.9||e.struct>.9)&&(s+=2e3*(Math.max(e.fi,e.eq,e.struct)-.9)**2);let f=400+100*i+15*c-60*l+120*u-a-s;return{meanR:i,cvar10:u,meanDD:l,meanIncome:c,penaltyDiv:a,penaltyConstraints:s,portfolioOutcomeScore:f}}let a={fi:.3,eq:.5,struct:.2,structSplitEquityNote:.6,equityNote:{buffer:.15,cap:.12,participation:1},incomeNote:{coupon:.1,barrier:.7,protection:"hard"}},s=(0,o.Ue)((t,e)=>({level:1,timeLeft:30,allocation:a,results:{},currentLevelId:null,startLevel:r=>{e().currentLevelId!==r&&t({level:r,timeLeft:30,currentLevelId:r})},tick:()=>{let r=e().timeLeft;r<=0||t({timeLeft:r-1})},setAllocation:r=>t({allocation:{...e().allocation,...r}}),finishLevel:()=>{let{level:r,allocation:o,results:u}=e();t({currentLevelId:null});let a=n.z.find(t=>t.id===r),s=c(l(a,50).map(t=>(0,i.ZX)(t,a,o)),o),f={totalR:s.meanR,maxDD:s.meanDD,income:s.meanIncome},m=s.portfolioOutcomeScore,d=function(t,e){let r=l(t,50),o=null;for(let n=0;n<=100;n+=5)for(let u=0;u<=100-n;u+=5){let l=100-n-u;if(l<0)continue;let a=l/100,s=n/100,f=u/100;if(!(Math.abs(s+f+a-1)>.001))for(let n of[0,.2,.4,.5,.6,.8,1])for(let u of[.1,.15,.2,.3])for(let l of[.08,.1,.12,.15,null])for(let m of[.06,.08,.1,.12])for(let d of[.6,.7,.8])for(let p of["hard","soft"]){let h={fi:s,eq:f,struct:a,structSplitEquityNote:n,equityNote:{...e.equityNote,buffer:u,cap:l},incomeNote:{coupon:m,barrier:d,protection:p}},q=c(r.map(e=>(0,i.ZX)(e,t,h)),h),y=q.portfolioOutcomeScore;(!o||y>o.portfolioOutcomeScore)&&(o={a:h,portfolioOutcomeScore:y,metrics:q})}}if(!o)throw Error("No optimal allocation found for market environment ".concat(t.id));let n={totalR:o.metrics.meanR,maxDD:o.metrics.meanDD,income:o.metrics.meanIncome};return{a:o.a,portfolioOutcomeScore:o.portfolioOutcomeScore,outcome:n,metrics:o.metrics}}(a,{equityNote:o.equityNote,incomeNote:o.incomeNote}),p=d.outcome,h=d.portfolioOutcomeScore,q=Math.max(h,m-1e-6);t({results:{...u,[r]:{regime:a,user:f,userAlloc:{...o},userPortfolioOutcomeScore:m,optimal:p,optimalAlloc:d.a,optimalPortfolioOutcomeScore:h,displayedOptimalPortfolioOutcomeScore:q}}})},reset:()=>t({level:1,timeLeft:30,allocation:a,results:{},currentLevelId:null})}))}}]);